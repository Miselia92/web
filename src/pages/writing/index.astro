---
import Layout from '../../layouts/Layout.astro';
import { getCollection } from 'astro:content';

const writing = await getCollection('writing');
// Sort by date desc
writing.sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());

const formatDate = (date: Date) => {
  return new Intl.DateTimeFormat('en-GB', {
    day: 'numeric',
    month: 'long',
    year: 'numeric',
  }).format(date);
};
---

<Layout title="Writing | Mark Power">
  <div class="px-6 md:px-12 py-12 max-w-4xl mx-auto">
    <h1 class="text-3xl font-light mb-12 uppercase tracking-wide">Writing</h1>
    
    <div class="flex flex-col gap-16">
      {writing.map((essay) => (
        <article class="group">
          <a href={`/writing/${essay.slug}`} class="flex flex-col md:flex-row gap-8 items-center group">
            {essay.data.coverImage && (
              <div class="w-full md:w-[30%] shrink-0 overflow-hidden aspect-[16/9] md:aspect-[4/3]">
                <img 
                  src={essay.data.coverImage} 
                  alt={essay.data.title}
                  class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105"
                />
              </div>
            )}
            <div class="flex-1">
                <h2 class="text-2xl font-normal group-hover:text-gray-600 transition-colors mb-2">
                {essay.data.title}
                </h2>
                <div class="text-xs uppercase tracking-widest text-gray-400 mb-4">
                    <time datetime={essay.data.date.toISOString()}>
                        {formatDate(essay.data.date)}
                    </time>
                </div>
                {essay.data.description && (
                    <p class="text-gray-600 leading-relaxed font-light mb-4">
                        {essay.data.description}
                    </p>
                )}
                <span class="text-xs border-b border-black pb-0.5 hover:border-gray-400 transition-colors">
                    Read Essay
                </span>
            </div>
          </a>
        </article>
      ))}
    </div>
  </div>
</Layout>
