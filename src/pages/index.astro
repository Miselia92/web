---
import Layout from '@/layouts/Layout.astro';
import { getHome } from '@/lib/content-tina';
import OptimizedImage from '@/components/OptimizedImage.astro';

const page = await getHome();
const { heroImages } = page;
const images = heroImages || [];
---

<Layout title="Mark Power | Magnum Photos">
	<div class="w-full flex justify-center items-center min-h-[80vh] px-6">
		<div class="w-full max-w-7xl mx-auto">
			<!-- Hero Carousel -->
			{images.length > 0 && (
			<div id="hero-carousel" class="relative w-[95%] mx-auto aspect-[3/2] bg-muted overflow-hidden">
				{images.map((src, index) => (
					<OptimizedImage 
						src={src} 
						alt={`Hero Image ${index + 1}`} 
						class={`absolute top-0 left-0 w-full h-full object-cover transition-opacity duration-1000 ${index === 0 ? 'opacity-100 z-10' : 'opacity-0 z-0'}`}
						loading={index === 0 ? 'eager' : 'lazy'}
						fetchpriority={index === 0 ? 'high' : 'low'}
					/>
				))}
			</div>
			)}

			<script>
				const images = document.querySelectorAll('#hero-carousel img');
				let currentIndex = 0;
				const intervalTime = 18000; // 18 seconds (between 15-20s)

				if (images.length > 0) {
					setInterval(() => {
						const currentImage = images[currentIndex];
						const nextIndex = (currentIndex + 1) % images.length;
						const nextImage = images[nextIndex];

						// Fade out current
						currentImage.classList.remove('opacity-100', 'z-10');
						currentImage.classList.add('opacity-0', 'z-0');

						// Fade in next
						nextImage.classList.remove('opacity-0', 'z-0');
						nextImage.classList.add('opacity-100', 'z-10');

						currentIndex = nextIndex;
					}, intervalTime);
				}
			</script>
			

		</div>
	</div>
</Layout>
