---
import Layout from '../../layouts/Layout.astro';
import { getCollection } from 'astro:content';

const projects = await getCollection('projects');
// Sort by year desc or order
projects.sort((a, b) => {
  const orderA = a.data.order ?? 99;
  const orderB = b.data.order ?? 99;
  if (orderA !== orderB) return orderA - orderB;
  return (b.data.year || '0').localeCompare(a.data.year || '0');
});
---

<Layout title="Projects | Mark Power">
  <div class="px-6 md:px-12 py-12">
    <h1 class="text-3xl font-light mb-12 uppercase tracking-wide">Projects</h1>
    
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 gap-y-12">
      {projects.map((project) => (
        <a href={`/projects/${project.slug}`} class="group block">
          <div class="aspect-[4/3] bg-gray-100 overflow-hidden mb-4 relative">
             {project.data.coverImage ? (
                <img 
                  src={project.data.coverImage} 
                  alt={project.data.title} 
                  class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105"
                />
             ) : (
                <div class="w-full h-full flex items-center justify-center text-gray-300 uppercase tracking-widest text-xs">
                  No Cover
                </div>
             )}
          </div>
          <h2 class="text-lg font-normal group-hover:text-gray-600 transition-colors uppercase tracking-wide">
            {project.data.title}
          </h2>
          {project.data.year && (
            <p class="text-xs text-gray-400 mt-1">{project.data.year}</p>
          )}
        </a>
      ))}
    </div>
  </div>
</Layout>
